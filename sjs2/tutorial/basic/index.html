<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/sjs2/assets/img/scala-js-logo-32.png">

    <title>Scala.js - Basic tutorial</title>

    <meta property="og:type" content="article" /><meta property="og:title" content="Basic tutorial" /><meta property="og:site_name" content="Scala.js" /><meta property="og:url" content="http://scala-js.org/tutorial/basic/" /><meta property="og:image" content="http://scala-js.org/assets/img/scala-js-logo-128.png" />

    <!-- Bootstrap core CSS -->
    <link href="/sjs2/assets/css/bootstrap.css" rel="stylesheet">
    <link href="/sjs2/assets/css/highlight.css" type="text/css" rel="stylesheet" media="screen,projection"/>

    <!-- Custom styles for this template -->
    <link href="/sjs2/assets/css/style.css" rel="stylesheet">
    <link href="/sjs2/assets/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.rawgit.com/zenorocha/clipboard.js/master/dist/clipboard.min.js"></script>
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<!-- Fixed navbar -->
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/sjs2/">Scala.js</a>
    </div>
    <div class="navbar-collapse collapse navbar-right">
      <ul class="nav navbar-nav">
        <li ><a href="/sjs2/doc">DOCUMENTATION</a></li>
        <li class="active"><a href="/sjs2/tutorial">TUTORIALS</a></li>
        <li ><a href="/sjs2/community">COMMUNITY</a></li>
        <li ><a href="/sjs2/news">NEWS</a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</div>
<div id="wrap">
<div id="main">
<div id="blue">
    <div class="container">
        <div class="row">
            <h3>Basic tutorial</h3>
        </div><!-- /row -->
    </div> <!-- /container -->
</div><!-- /blue -->

<div class="container mtb">
    <div class="row">
        <div class="col-md-9">
            <p>This step-by-step tutorial where we start with the setup of a Scala.js sbt project and end up having some user interaction and unit testing. The code created in this tutorial is available with one commit per step in the <a href="https://github.com/scala-js/scalajs-tutorial">scalajs-tutorial</a> repository on GitHub.</p>

<h2 id="a-nameprerequisitesa-step-0-prerequisites"><a name="prerequisites"></a> Step 0: Prerequisites</h2>

<p>To go through this tutorial, you will need to <a href="http://www.scala-sbt.org/0.13/tutorial/Setup.html">download &amp; install sbt</a> (&gt;= 0.13.0). Note that no prior sbt knowledge (only a working installation) is required to follow the tutorial.</p>

<h2 id="a-namesetupa-step-1-setup"><a name="setup"></a> Step 1: Setup</h2>

<p>First create a new folder where your sbt project will go.</p>

<h3 id="sbt-setup">sbt Setup</h3>

<p>To setup Scala.js in a new sbt project, we need to do two things:</p>

<ol>
  <li>Add the Scala.js sbt plugin to the build</li>
  <li>Enable the plugin in the project</li>
</ol>

<p>Adding the Scala.js sbt plugin is a one-liner in <code>project/plugins.sbt</code> (all file names we write in this tutorial are relative to the project root):</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">addSbtPlugin</span><span class="o">(</span><span class="s">&quot;org.scala-js&quot;</span> <span class="o">%</span> <span class="s">&quot;sbt-scalajs&quot;</span> <span class="o">%</span> <span class="s">&quot;&quot;</span><span class="o">)</span></code></pre></div>

<p>We also setup basic project settings and enable this plugin in the sbt build file (<code>build.sbt</code>, in the project root directory):</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">enablePlugins</span><span class="o">(</span><span class="nc">ScalaJSPlugin</span><span class="o">)</span>

<span class="n">name</span> <span class="o">:=</span> <span class="s">&quot;Scala.js Tutorial&quot;</span>

<span class="n">scalaVersion</span> <span class="o">:=</span> <span class="s">&quot;2.11.5&quot;</span> <span class="c1">// or any other Scala version &gt;= 2.10.2</span></code></pre></div>

<p>Last, we need a <code>project/build.properties</code> to specify the sbt version (&gt;= 0.13.7):</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">sbt</span><span class="o">.</span><span class="n">version</span><span class="k">=</span><span class="mf">0.13</span><span class="o">.</span><span class="mi">7</span></code></pre></div>

<p>That is all we need to configure the build.</p>

<p>If at this point you prefer to use Eclipse or IDEA as your IDE, you may use <a href="https://github.com/typesafehub/sbteclipse/wiki/Using-sbteclipse">sbteclipse</a> to generate an Eclipse project, or import the sbt build from IDEA. Note that for compiling and running your application, you will still need to use sbt from the command line.</p>

<h3 id="helloworld-application">HelloWorld application</h3>

<p>For starters, we add a very simple <code>TutorialApp</code> in the <code>tutorial.webapp</code> package. Create the file <code>src/main/scala/tutorial/webapp/TutorialApp.scala</code>:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">package</span> <span class="nn">tutorial.webapp</span>

<span class="k">import</span> <span class="nn">scala.scalajs.js.JSApp</span>

<span class="k">object</span> <span class="nc">TutorialApp</span> <span class="k">extends</span> <span class="nc">JSApp</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">main</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="n">println</span><span class="o">(</span><span class="s">&quot;Hello world!&quot;</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>As you expect, this will simply print “HelloWorld” when run. To run this, simply launch <code>sbt</code> and invoke the <code>run</code> task:</p>

<pre><code>$ sbt
&gt; run
[info] Compiling 1 Scala source to (...)/scala-js-tutorial/target/scala-2.11/classes...
[info] Running tutorial.webapp.TutorialApp
Hello world!
[success] (...)
</code></pre>

<p><strong>Troubleshooting</strong>: Should you experience errors with the <code>PermGen</code> size of the JVM at this point, you can increase it. Refer, for example, to <a href="http://stackoverflow.com/questions/8331135/transient-outofmemoryerror-when-compiling-scala-classes">this StackOverflow question</a>.</p>

<p>Congratulations! You have successfully compiled and run your first Scala.js application. The code is actually run by a JavaScript interpreter. If you do not believe this (it happens to us occasionally), you can use the <code>last</code> command in sbt:</p>

<pre><code>&gt; last
(...)
[info] Running tutorial.webapp.TutorialApp
[debug] with JSEnv of type class org.scalajs.jsenv.rhino.RhinoJSEnv
[debug] with classpath of type class org.scalajs.core.tools.classpath.IRClasspath
[success] (...)
</code></pre>

<p>So your code has actually been executed by the <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Rhino">Rhino</a> JavaScript interpreter.</p>

<h3 id="run-with-nodejs-optional-but-recommended">Run with Node.js (optional, but recommended)</h3>

<p>Rhino is cool because it runs out of the box, without having to install anything.
But it is <em>terribly</em> slow.
In general, you do not want to use it for your day-to-day development.</p>

<p><a href="http://nodejs.org/">Node.js</a> is a much more performant JavaScript engine.
To run your code with Node.js, you need to install it, and enable
<code>FastOptStage</code> in sbt using this command:</p>

<pre><code>&gt; set scalaJSStage in Global := FastOptStage
&gt; run
[info] Fast optimizing C:\Users\Sepi\Documents\Projets\scalajs-tutorial\target\scala-2.11\scala-js-tutorial-fastopt.js
[info] Running tutorial.webapp.TutorialApp
Hello world!
[success] (...)
</code></pre>

<p>The <code>last</code> command now shows that this was run with Node.js:</p>

<pre><code>&gt; last
(...)
[info] Running tutorial.webapp.TutorialApp
[debug] with JSEnv of type class org.scalajs.jsenv.nodejs.NodeJSEnv
[debug] with classpath of type class org.scalajs.core.tools.classpath.LinkedClasspath
[success] (...)
</code></pre>

<p>The stage needs to be set once per sbt session.
Alternatively, you can include the setting directly in your <code>build.sbt</code>, or,
in order not to disturb your teammates, in a separate <code>.sbt</code> file (say,
<code>local.sbt</code>):</p>

<pre><code>scalaJSStage in Global := FastOptStage
</code></pre>

<p>This will enable the fastOpt stage by default when launching sbt.</p>

<p><strong>Source maps in Node.js</strong>: To get your stack traces resolved on Node.js, you will have to install the <code>source-map-support</code> package.</p>

<pre><code>npm install source-map-support
</code></pre>

<h2 id="a-nameintegrating-htmla-step-2-integrating-with-html"><a name="integrating-html"></a> Step 2: Integrating with HTML</h2>

<p>Now that we have a simple JavaScript application, we would like to use it in an HTML page. To do this, we need two steps:</p>

<ol>
  <li>Generate a single JavaScript file out of our compiled code</li>
  <li>Create an HTML page which includes that file and calls the application</li>
</ol>

<h3 id="generate-javascript">Generate JavaScript</h3>

<p>To generate a single JavaScript file using sbt, just use the <code>fastOptJS</code> task:</p>

<pre><code>&gt; fastOptJS
[info] Fast optimizing (...)/scala-js-tutorial/target/scala-2.11/scala-js-tutorial-fastopt.js
[success] (...)
</code></pre>

<p>This will perform some fast optimizations and generate the <code>target/scala-2.11/scala-js-tutorial-fastopt.js</code> file containing the JavaScript code.</p>

<p>(It is possible that the <code>[info]</code> does not appear, if you have just run the program in fastOpt mode.)</p>

<h3 id="create-the-html-page">Create the HTML Page</h3>

<p>To load and launch the created JavaScript, you will need an HTML file. Create the file <code>scalajs-tutorial-fastopt.html</code> (or whatever name you prefer, for example <code>index-dev.html</code>) in the project root with the following content. We will go in the details right after.</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;UTF-8&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>The Scala.js Tutorial<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="c">&lt;!-- Include Scala.js compiled code --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;./target/scala-2.11/scala-js-tutorial-fastopt.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="c">&lt;!-- Run tutorial.webapp.TutorialApp --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
      <span class="nx">tutorial</span><span class="p">.</span><span class="nx">webapp</span><span class="p">.</span><span class="nx">TutorialApp</span><span class="p">().</span><span class="nx">main</span><span class="p">();</span>
    <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></div>

<p>The first script tag simply includes the generated code (attention, you might need to adapt the Scala version from <code>2.11</code> to <code>2.10</code> here if you are using Scala 2.10.x instead of 2.11.x).</p>

<p>In the second script tag, we first get the <code>TutorialApp</code> object. Note the <code>()</code>: <code>TutorialApp</code> is a function in JavaScript, since potential object initialization code needs to be run upon the first access to the object. We then simply call the <code>main</code> method on the <code>TutorialApp</code> object.</p>

<p>Since <code>TutorialApp</code> extends <code>JSApp</code>, the object itself and its <code>main</code> method are automatically made available to
JavaScript. This is not true in general. Continue reading this tutorial or have a look at the <a href="../../doc/interoperability/export_to_js.html">Export Scala.js API to
JavaScript</a> guide for details.</p>

<p>If you now open the newly created HTML page in your favorite browser, you will see … nothing. The <code>println</code> in the <code>main</code> method goes right to the JavaScript console, which is not shown by default in a browser. However, if you open the JavaScript console (e.g. in Chrome: right click -&gt; Inspect Element -&gt; Console) you can see the HelloWorld message.</p>

<h2 id="a-nameusing-doma-step-3-using-the-dom"><a name="using-dom"></a> Step 3: Using the DOM</h2>

<p>As the last step has shown, running JavaScript inside an HTML page is not particularly useful if you cannot interact with the page.
That’s what the DOM API is for.</p>

<h3 id="adding-the-dom-library">Adding the DOM Library</h3>

<p>To use the DOM, it is best to use the statically typed Scala.js DOM library. To add it to your sbt project, add the following line to your <code>build.sbt</code>:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">&quot;org.scala-js&quot;</span> <span class="o">%%%</span> <span class="s">&quot;scalajs-dom&quot;</span> <span class="o">%</span> <span class="s">&quot;0.8.0&quot;</span></code></pre></div>

<p>sbt-savvy folks will notice the <code>%%%</code> instead of the usual <code>%%</code>. It means we are using a Scala.js library and not a
normal Scala library. Have a look at the <a href="../../doc/project/dependencies.html">Dependencies</a> guide for details. Don’t forget
to reload the build file if sbt is still running:</p>

<pre><code>&gt; reload
[info] Loading global plugins from (...)
[info] Loading project definition from (...)/scala-js-tutorial/project
[info] Set current project to Scala.js Tutorial (in build (...)/scala-js-tutorial/)
</code></pre>

<p>If you are using an IDE plugin, you will also have to regenerate the project files for autocompletion to work.</p>

<h3 id="using-the-dom-library">Using the DOM Library</h3>

<p>Now that we added the DOM library, let’s adapt our HelloWorld example to add a <code>&lt;p&gt;</code> tag to the body of the page, rather than printing to the console.</p>

<p>First of all, we import a couple of things:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.scalajs.dom</span>
<span class="k">import</span> <span class="nn">dom.document</span></code></pre></div>

<p><code>dom</code> is the root of the JavaScript DOM and corresponds to the global scope of Script (aka the <code>window</code> object).
We additionally import <code>document</code> (which corresponds to <code>document</code> in JavaScript) for convenience.</p>

<p>We now create a method that allows us to append a <code>&lt;p&gt;</code> tag with a given text to a given node:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">appendPar</span><span class="o">(</span><span class="n">targetNode</span><span class="k">:</span> <span class="kt">dom.Node</span><span class="o">,</span> <span class="n">text</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">parNode</span> <span class="k">=</span> <span class="n">document</span><span class="o">.</span><span class="n">createElement</span><span class="o">(</span><span class="s">&quot;p&quot;</span><span class="o">)</span>
  <span class="k">val</span> <span class="n">textNode</span> <span class="k">=</span> <span class="n">document</span><span class="o">.</span><span class="n">createTextNode</span><span class="o">(</span><span class="n">text</span><span class="o">)</span>
  <span class="n">parNode</span><span class="o">.</span><span class="n">appendChild</span><span class="o">(</span><span class="n">textNode</span><span class="o">)</span>
  <span class="n">targetNode</span><span class="o">.</span><span class="n">appendChild</span><span class="o">(</span><span class="n">parNode</span><span class="o">)</span>
<span class="o">}</span></code></pre></div>

<p>Replace the call to <code>println</code> with a call to <code>appendPar</code> in the <code>main</code> method:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">main</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
  <span class="n">appendPar</span><span class="o">(</span><span class="n">document</span><span class="o">.</span><span class="n">body</span><span class="o">,</span> <span class="s">&quot;Hello World&quot;</span><span class="o">)</span>
<span class="o">}</span></code></pre></div>

<h3 id="rebuild-the-javascript">Rebuild the JavaScript</h3>

<p>To rebuild the JavaScript, simply invoke <code>fastOptJS</code> again:</p>

<pre><code>&gt; fastOptJS
[info] Compiling 1 Scala source to (...)/scala-js-tutorial/target/scala-2.11/classes...
[info] Fast optimizing (...)/scala-js-tutorial/target/scala-2.11/scala-js-tutorial-fastopt.js
[success] (...)
</code></pre>

<p>As you can see from the log, sbt automatically detects that the sources must be recompiled before fast optimizing.</p>

<p>You can now reload the HTML in your browser and you should see a nice “Hello World” message.</p>

<p>Re-typing <code>fastOptJS</code> each time you change your source file is cumbersome. Luckily sbt is able to watch your files and recompile as needed:</p>

<pre><code>&gt; ~fastOptJS
[success] (...)
1. Waiting for source changes... (press enter to interrupt)
</code></pre>

<p>From this point in the tutorial we assume you have an sbt with this command running, so we don’t need to bother with rebuilding each time.</p>

<h2 id="a-namejs-exporta-step-4-reacting-on-user-input"><a name="js-export"></a> Step 4: Reacting on User Input</h2>

<p>This step shows how you can add a button and react to events on it by still just using the DOM (we will use jQuery in the next step). We want to add a button that adds another <code>&lt;p&gt;</code> tag to the body when it is clicked.</p>

<p>We start by adding a method to <code>TutorialApp</code> which will be called when the button is clicked:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nd">@JSExport</span>
<span class="k">def</span> <span class="n">addClickedMessage</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
  <span class="n">appendPar</span><span class="o">(</span><span class="n">document</span><span class="o">.</span><span class="n">body</span><span class="o">,</span> <span class="s">&quot;You clicked the button!&quot;</span><span class="o">)</span>
<span class="o">}</span></code></pre></div>

<p>You will notice the <code>@JSExport</code> annotation. It tells the Scala.js compiler to make that method callable from JavaScript. We must also import this annotation:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">scala.scalajs.js.annotation.JSExport</span></code></pre></div>

<p>To find out more about how to call Scala.js methods from JavaScript, have a look at the <a href="../../doc/interoperability/export_to_js.html">Export Scala.js API to
JavaScript</a> guide.</p>

<p>Since we now have a method that is callable from JavaScript, all we have to do is add a button to our HTML and set its
<code>onclick</code> attribute (make sure to add the button <em>before</em> the <code>&lt;script&gt;</code> tags):</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">&quot;click-me-button&quot;</span> <span class="na">type=</span><span class="s">&quot;button&quot;</span> <span class="na">onclick=</span><span class="s">&quot;tutorial.webapp.TutorialApp().addClickedMessage()&quot;</span><span class="nt">&gt;</span>Click me!<span class="nt">&lt;/button&gt;</span></code></pre></div>

<p>Reload your HTML page (remember, sbt compiles your code automatically) and try to click the button. It should add a new
paragraph saying “You clicked the button!” each time you click it.</p>

<h2 id="a-nameusing-jquerya-step-5-using-jquery"><a name="using-jquery"></a> Step 5: Using jQuery</h2>

<p>Larger web applications have a tendency to set up reactions to events in JavaScript rather than specifying attributes.
We will transform our current mini-application to use this paradigm with the help of jQuery. Also we will replace all
usages of the DOM API with jQuery.</p>

<h3 id="depending-on-jquery">Depending on jQuery</h3>

<p>Just like for the DOM, there is a typed library for jQuery available in Scala.js. Replace the 
<code>libraryDependencies += ..</code> line in your <code>build.sbt</code> by:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">&quot;be.doeraene&quot;</span> <span class="o">%%%</span> <span class="s">&quot;scalajs-jquery&quot;</span> <span class="o">%</span> <span class="s">&quot;0.8.0&quot;</span></code></pre></div>

<p>Since we won’t be using the DOM directly, we don’t need the old library anymore. Note that the jQuery library internally
depends on the DOM, but we don’t have to care about this. sbt takes care of it automatically.</p>

<p>Don’t forget to reload the sbt configuration now:</p>

<ol>
  <li>Hit enter to abort the <code>~fastOptJS</code> command</li>
  <li>Type <code>reload</code></li>
  <li>Start <code>~fastOptJS</code> again</li>
</ol>

<p>Again, make sure to update your IDE project files if you are using a plugin.</p>

<h3 id="using-jquery">Using jQuery</h3>

<p>In <code>TutorialApp.scala</code>, remove the imports for the DOM, and add the import for jQuery:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.scalajs.jquery.jQuery</span></code></pre></div>

<p>This allows you to easily access the <code>jQuery</code> object (usually referred to as <code>$</code> in JavaScript) in your code.</p>

<p>We can now remove <code>appendPar</code> and replace all calls to it by the simple:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">jQuery</span><span class="o">(</span><span class="s">&quot;body&quot;</span><span class="o">).</span><span class="n">append</span><span class="o">(</span><span class="s">&quot;&lt;p&gt;[message]&lt;/p&gt;&quot;</span><span class="o">)</span></code></pre></div>

<p>Where <code>[message]</code> is the string originally passed to <code>appendPar</code>.</p>

<p>If you try to reload your webpage now, it will not work (typically a <code>TypeError</code> would be reported in the console). The
problem is that we haven’t included the jQuery library itself, which is a plain JavaScript library.</p>

<h3 id="adding-javascript-libraries">Adding JavaScript libraries</h3>

<p>An option is to include <code>jquery.js</code> from an external source, such as <a href="http://www.jsdelivr.com/">jsDelivr</a>.</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;http://cdn.jsdelivr.net/jquery/2.1.1/jquery.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></code></pre></div>

<p>This can easily become very cumbersome, if you depend on multiple libraries. The Scala.js sbt plugin provides a
mechanism for libraries to declare the plain JavaScript libraries they depend on and bundle them in a single file. All
you have to do is activate this and then include the file.</p>

<p>In your <code>build.sbt</code>, set:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">skip</span> <span class="n">in</span> <span class="n">packageJSDependencies</span> <span class="o">:=</span> <span class="kc">false</span></code></pre></div>

<p>After reloading and rerunning <code>fastOptJS</code>, this will create <code>scala-js-tutorial-jsdeps.js</code> containing all JavaScript
libraries next to the main JavaScript file. We can then simply include this file and don’t need to worry about
JavaScript libraries anymore:</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- Include JavaScript dependencies --&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;./target/scala-2.11/scala-js-tutorial-jsdeps.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></code></pre></div>

<h3 id="setup-ui-in-scalajs">Setup UI in Scala.js</h3>

<p>We still want to get rid of the <code>onclick</code> attribute of our <code>&lt;button&gt;</code>. After removing the attribute, we add the
<code>setupUI</code> method, in which we use jQuery to add an event handler to the button. We also move the “Hello World” message
into this function.</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">setupUI</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
  <span class="n">jQuery</span><span class="o">(</span><span class="s">&quot;#click-me-button&quot;</span><span class="o">).</span><span class="n">click</span><span class="o">(</span><span class="n">addClickedMessage</span> <span class="k">_</span><span class="o">)</span>
  <span class="n">jQuery</span><span class="o">(</span><span class="s">&quot;body&quot;</span><span class="o">).</span><span class="n">append</span><span class="o">(</span><span class="s">&quot;&lt;p&gt;Hello World&lt;/p&gt;&quot;</span><span class="o">)</span>
<span class="o">}</span></code></pre></div>

<p>Since we do not call <code>addClickedMessage</code> from plain JavaScript anymore, we can remove the <code>@JSExport</code> annotation (and
the corresponding import).</p>

<p>Finally, we add a last call to <code>jQuery</code> in the main method, in order to execute <code>setupUI</code>, once the DOM is loaded:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">main</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
  <span class="n">jQuery</span><span class="o">(</span><span class="n">setupUI</span> <span class="k">_</span><span class="o">)</span>
<span class="o">}</span></code></pre></div>

<p>Again, since we are not calling <code>setupUI</code> directly from plain JavaScript, we do not need to export it (even though
jQuery will call it).</p>

<p>We now have an application whose UI is completely setup from within Scala.js. The next step will show how we can test
this application.</p>

<h2 id="a-nametestinga-step-6-testing"><a name="testing"></a> Step 6: Testing</h2>

<p>In this section we will show how such an application can be tested using <a href="http://github.com/lihaoyi/utest">uTest</a>, a
tiny testing framework which compiles to both Scala.js and Scala JVM. As a note aside, this framework is also a good
choice to test libraries that cross compile. See our <a href="../../doc/project/cross_build.html">cross compilation guide</a> for
details.</p>

<h3 id="supporting-the-dom">Supporting the DOM</h3>

<p>Before we start writing tests which we will be able to run through the sbt console, we first have to solve another
issue. Remember the task <code>run</code>? If you try to invoke it now, you will see something like this:</p>

<pre><code>&gt; run
[info] Running tutorial.webapp.TutorialApp
org.mozilla.javascript.EcmaError: ReferenceError: "window" is not defined. (/home/ts/.ivy2/cache/org.webjars/jquery/jars/jquery-1.10.2.jar#META-INF/resources/webjars/jquery/1.10.2/jquery.js#14)
(...)
[trace] Stack trace suppressed: run last compile:run for the full output.
[error] (compile:run) Exception while running JS code: ReferenceError: "window" is not defined. (/home/ts/.ivy2/cache/org.webjars/jquery/jars/jquery-1.10.2.jar#META-INF/resources/webjars/jquery/1.10.2/jquery.js#14)
[error] (...)
</code></pre>

<p>What basically happens here is that jQuery (yes, it is included automatically) tries to access the <code>window</code> object of
the DOM, which doesn’t exist by default in the Rhino and Node.js runners. To make the DOM available, add the following
to your <code>build.sbt</code>:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">jsDependencies</span> <span class="o">+=</span> <span class="nc">RuntimeDOM</span></code></pre></div>

<p>If you use the fastOpt stage, this will switch to running your code with <a href="http://phantomjs.org/">PhantomJS</a> instead of
Node.js, which you need to install. Otherwise, in Rhino, a fake DOM is automatically made available.</p>

<p>After reloading, you can invoke <code>run</code> successfully:</p>

<pre><code>&gt; run
[info] Running tutorial.webapp.TutorialApp
[success] (...)
</code></pre>

<p>Just like other library dependencies, this setting applies transitively: if you depend on a library that depends on the
DOM, then you depend on the DOM as well.</p>

<h3 id="adding-utest">Adding uTest</h3>

<p>Using a testing framework in Scala.js is not much different than on the JVM.
It typically boils down to two sbt settings in the <code>build.sbt</code> file.
For uTest, these are:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">&quot;com.lihaoyi&quot;</span> <span class="o">%%%</span> <span class="s">&quot;utest&quot;</span> <span class="o">%</span> <span class="s">&quot;0.3.0&quot;</span> <span class="o">%</span> <span class="s">&quot;test&quot;</span>

<span class="n">testFrameworks</span> <span class="o">+=</span> <span class="k">new</span> <span class="nc">TestFramework</span><span class="o">(</span><span class="s">&quot;utest.runner.Framework&quot;</span><span class="o">)</span></code></pre></div>

<p>We are now ready to add a first simple test suite (<code>src/test/scala/tutorial/webapp/TutorialTest.scala</code>):</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">package</span> <span class="nn">tutorial.webapp</span>

<span class="k">import</span> <span class="nn">utest._</span>

<span class="k">import</span> <span class="nn">org.scalajs.jquery.jQuery</span>

<span class="k">object</span> <span class="nc">TutorialTest</span> <span class="k">extends</span> <span class="nc">TestSuite</span> <span class="o">{</span>

  <span class="c1">// Initialize App</span>
  <span class="nc">TutorialApp</span><span class="o">.</span><span class="n">setupUI</span><span class="o">()</span>

  <span class="k">def</span> <span class="n">tests</span> <span class="k">=</span> <span class="nc">TestSuite</span> <span class="o">{</span>
    <span class="-Symbol">&#39;HelloWorld</span> <span class="o">{</span>
      <span class="n">assert</span><span class="o">(</span><span class="n">jQuery</span><span class="o">(</span><span class="s">&quot;p:contains(&#39;Hello World&#39;)&quot;</span><span class="o">).</span><span class="n">length</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>This test uses jQuery to verify that our page contains exactly one <code>&lt;p&gt;</code> element which contains the text “Hello World”
after the UI has been set up.</p>

<p>To run this test, simply invoke the <code>test</code> task:</p>

<pre><code>&gt; test
[info] Compiling 1 Scala source to (...)/scalajs-tutorial/target/scala-2.11/test-classes...
[info] 1/2     tutorial.webapp.TutorialTest.HelloWorld		Success
[info] 2/2     tutorial.webapp.TutorialTest		Success
[info] -----------------------------------Results-----------------------------------
[info] tutorial.webapp.TutorialTest		Success
[info]     HelloWorld		Success
[info] Failures:
[info]
[info] Tests: 2
[info] Passed: 2
[info] Failed: 0
[success] (...)
</code></pre>

<p>We have successfully created a simple test.
Just like <code>run</code>, the <code>test</code> task uses Rhino by default, or Node.js/PhantomJS in fastOpt stage.</p>

<h3 id="a-more-complex-test">A more complex test</h3>

<p>We also would like to test the functionality of our button. For this we face another small issue: the button doesn’t
exist when testing, since the tests start with an empty DOM tree. To solve this, we create the button in the <code>setupUI</code>
method and remove it from the HTML:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">jQuery</span><span class="o">(</span><span class="s">&quot;&quot;&quot;&lt;button type=&quot;button&quot;&gt;Click me!&lt;/button&gt;&quot;&quot;&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">click</span><span class="o">(</span><span class="n">addClickedMessage</span> <span class="k">_</span><span class="o">)</span>
  <span class="o">.</span><span class="n">appendTo</span><span class="o">(</span><span class="n">jQuery</span><span class="o">(</span><span class="s">&quot;body&quot;</span><span class="o">))</span></code></pre></div>

<p>This brings another unexpected advantage: We don’t need to give it an ID anymore but can directly use the jQuery object
to install the on-click handler.</p>

<p>We now define the <code>ButtonClick</code> test just below the <code>HelloWorld</code> test:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="-Symbol">&#39;ButtonClick</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">messageCount</span> <span class="k">=</span>
    <span class="n">jQuery</span><span class="o">(</span><span class="s">&quot;p:contains(&#39;You clicked the button!&#39;)&quot;</span><span class="o">).</span><span class="n">length</span>

  <span class="k">val</span> <span class="n">button</span> <span class="k">=</span> <span class="n">jQuery</span><span class="o">(</span><span class="s">&quot;button:contains(&#39;Click me!&#39;)&quot;</span><span class="o">)</span>
  <span class="n">assert</span><span class="o">(</span><span class="n">button</span><span class="o">.</span><span class="n">length</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span>
  <span class="n">assert</span><span class="o">(</span><span class="n">messageCount</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>

  <span class="k">for</span> <span class="o">(</span><span class="n">c</span> <span class="k">&lt;-</span> <span class="mi">1</span> <span class="n">to</span> <span class="mi">5</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">button</span><span class="o">.</span><span class="n">click</span><span class="o">()</span>
    <span class="n">assert</span><span class="o">(</span><span class="n">messageCount</span> <span class="o">==</span> <span class="n">c</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>After defining a helper method that counts the number of messages, we retrieve the button from the DOM and verify we
have exactly one button and no messages. In the loop, we simulate a click on the button and then verify that the number
of messages has increased.</p>

<p>You can now call the <code>test</code> task again:</p>

<pre><code>&gt; test
[info] Compiling 1 Scala source to (...)/scalajs-tutorial/target/scala-2.11/test-classes...
[info] 1/3     tutorial.webapp.TutorialTest.HelloWorld		Success
[info] 2/3     tutorial.webapp.TutorialTest.ButtonClick		Success
[info] 3/3     tutorial.webapp.TutorialTest		Success
[info] -----------------------------------Results-----------------------------------
[info] tutorial.webapp.TutorialTest		Success
[info]     HelloWorld		Success
[info]     ButtonClick		Success
[info] Failures:
[info]
[info] Tests: 3
[info] Passed: 3
[info] Failed: 0
[success] (...)
</code></pre>

<p>This completes the testing part of this tutorial.</p>

<h2 id="a-nameoptimizinga-step-7-optimizing-for-production"><a name="optimizing"></a> Step 7: Optimizing for Production</h2>

<p>Here we show a couple of things you might want to do when you promote your application to production.</p>

<h3 id="full-optimization">Full Optimization</h3>

<p>Size is critical for JavaScript code on the web. To compress the compiled code even further, the Scala.js sbt plugin
uses the advanced optimizations of the <a href="http://developers.google.com/closure/compiler/">Google Closure Compiler</a>. To run
full optimizations, simply use the <code>fullOptJS</code> task:</p>

<pre><code>&gt; fullOptJS
[info] Optimizing (...)/scala-js-tutorial/target/scala-2.11/scala-js-tutorial-opt.js
[info] Closure: 0 error(s), 0 warning(s)
[success] (...)
</code></pre>

<p>Note that this can take a while on a larger project (tens of seconds), which is why we typically don’t use <code>fullOptJS</code>
during development, but <code>fastOptJS</code> instead. If you have used the <code>FastOptStage</code> before, there is a corresponding
<code>FullOptStage</code> to run code after full optimization.</p>

<h3 id="automatically-creating-a-launcher">Automatically Creating a Launcher</h3>

<p>Before creating another HTML file which includes the fully optimized JavaScript, we are going to introduce another
feature of the sbt plugin. Since the sbt plugin is able to detect the <code>JSApp</code> object of the application, there is no
need to repeat this in the HTML file. If you add the following setting to your <code>build.sbt</code>, sbt will create a
<code>scala-js-tutorial-launcher.js</code> file which calls the main method:</p>

<div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">persistLauncher</span> <span class="n">in</span> <span class="nc">Compile</span> <span class="o">:=</span> <span class="kc">true</span>

<span class="n">persistLauncher</span> <span class="n">in</span> <span class="nc">Test</span> <span class="o">:=</span> <span class="kc">false</span></code></pre></div>

<p>We set <code>persistLauncher</code> to false for testing, since we do not have an application to run. In our HTML page, we can now
include this file instead of the manual launcher:</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- Run JSApp --&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;./target/scala-2.11/scala-js-tutorial-launcher.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span></code></pre></div>

<p>If we rename our <code>JSApp</code> object, we need not change our HTML at all anymore. Note that the launcher generation only
works if you have a single <code>JSApp</code> object. If you happen to have multiple <code>JSApp</code> objects but still would like to
generate a launcher, you can set the <code>JSApp</code> object explicitly. Have a look at the <a href="../../doc/project/building.html">Compiling, Running, Linking,
Optimizing</a> guide for more details.</p>

<h3 id="putting-it-all-together">Putting it all Together</h3>

<p>We can now create our final production HTML file <code>scalajs-tutorial.html</code> which includes the fully optimized code:</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;UTF-8&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>The Scala.js Tutorial<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="c">&lt;!-- Include JavaScript dependencies --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;./target/scala-2.11/scala-js-tutorial-jsdeps.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="c">&lt;!-- Include Scala.js compiled code --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;./target/scala-2.11/scala-js-tutorial-opt.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="c">&lt;!-- Run main object --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;./target/scala-2.11/scala-js-tutorial-launcher.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></div>

<p>This completes the Scala.js tutorial. Refer to our <a href="../../doc/index.html">documentation page</a> for deeper insights into various
aspects of Scala.js.</p>


            <div class="spacing"></div>
        </div>
        <div class="col-md-3">
            <nav class="toc" role="navigation">
                
<ul>
    
    <li>
        <a href="/sjs2/tutorial/">
            
            Tutorials
            
        </a>
    </li>
    
    
    <li>
        <a href="/sjs2/tutorial/basic/">
            
            <b>Basic tutorial</b>
            
        </a>
    </li>
    
    
</ul>

            </nav>
        </div>
    </div>
</div>

</div>
</div>
<div id="footerwrap">
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <h4>LEARN</h4>

                <div class="hline-w"></div>
                <a class="grey-text text-lighten-3" href="/sjs2/doc">Documentation</a><br/>
                <a class="grey-text text-lighten-3" href="/sjs2/tutorial">Tutorial</a><br/>
                <a class="grey-text text-lighten-3" href="/sjs2/doc/faq.html">FAQ</a>
            </div>
            <div class="col-md-4">
                <h4>COMMUNITY</h4>

                <div class="hline-w"></div>
                <a class="grey-text text-lighten-3" href="https://gitter.im/scala-js/scala-js">Gitter chat</a><br/>
                <a class="grey-text text-lighten-3" href="http://stackoverflow.com/questions/tagged/scala.js">Stackoverflow</a><br/>
                <a class="grey-text text-lighten-3" href="https://groups.google.com/forum/?fromgroups#!forum/scala-js">Mailing list</a>
            </div>
            <div class="col-md-4">
            </div>
        </div>
    </div>
</div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="/sjs2/assets/js/bootstrap.min.js"></script>
<script src="/sjs2/assets/js/highlight.pack.js"></script>
<script src="/sjs2/assets/js/custom.js"></script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-42008737-1', 'scala-js.org');
ga('send', 'pageview');
</script>

</body>
</html>